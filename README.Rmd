---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ModulonCore

<!-- badges: start -->
<!-- badges: end -->

The goal of ModulonCore is to identify the modulon regulatory cores or connected components with statistically supported over-connectivity

## Installation

You can install the development version of ModulonCore from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("icrespocasajus/ModulonCore")
```

## Example

This is a basic example which shows you how to find and explore the regulatory cores of a given set of modulons

```{r example, echo=T, results='hide'}
library(ModulonCore)
library(igraph)
library(SANTA)
# For this example we will use the TILs dataset included in ModulonCore

# Build the graph
graph = build.graph(network.TILs)
# Transform the graph into an igraph object
igraph = build.igraph(graph)
# Look for connected components
cc=find.connected.components(net=igraph,modulons = modulons.TILs)
# Check the statistical over-connectivity of the connected components
set.seed(123)
results.connectivity=connectivity( 
 net=igraph,
 cc=cc,
 min.size='5',
 dist.method="shortest.paths",
 nperm=100,
 vertex.attr="query",
 edge.attr="Weight",
 significance=0.05)
```

We can collect the identified regulatory cores as follows:

```{r regulatory core IDs}
# Collect the regulatory cores IDs
regulatory.cores=core(results.connectivity=results.connectivity)
regulatory.cores
```

The regulatory cores can be printed out using the core.out() function: 

```{r regulatory core out}
core.out(net=graph,cc=cc,regulatory.cores=regulatory.cores,dir="./cores")
```

Plot the results of the connectivity analysis for the regulatory core of modulon 5

```{r plot connectivity modulon 5 cc.1}
# Explore results for modulon 5

# Connectivity analysis plot
plot(results.connectivity[['5']][['cc.1']])
```
Show the pvalue (empiric z-score) of the connectivity analysis for the regulatory core of modulon 5
```{r pvalue connectivity modulon 5 cc.1}
# pvalue
results.connectivity[['5']][['cc.1']]$pval
```
Plot the results of the connectivity analysis for the regulatory core of modulon 3
```{r plot connectivity modulon 3 cc.3}
# Explore results for modulon 3
plot(results.connectivity[['3']][['cc.3']])
```

Show the pvalue (empiric z-score) of the connectivity analysis for the regulatory core of modulon 3
```{r pvalue connectivity modulon 3 cc.3}
# pvalue
results.connectivity[['3']][['cc.3']]$pval
```

## Author

Isaac Crespo

```{r pressure, echo = FALSE}
plot(pressure)
```

Isaac Crespo, phD
Senior Computational Scientist,
CHUV | Department of Oncology | George Coukos group
Ludwig Institute for Cancer Research |  Lausanne Branch
AGORA, Bugnon 25A, 1005 Lausanne, 4th floor, Room 38
isaaccrespo@hotmail.com

